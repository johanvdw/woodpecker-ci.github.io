"use strict";(self.webpackChunkwoodpecker=self.webpackChunkwoodpecker||[]).push([[1213],{17942:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>g});var a=t(50959);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=p(t),u=r,g=m["".concat(s,".").concat(u)]||m[u]||d[u]||i;return t?a.createElement(g,o(o({ref:n},c),{},{components:t})):a.createElement(g,o({ref:n},c))}));function g(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=u;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[m]="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},87514:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>f,contentTitle:()=>v,default:()=>k,frontMatter:()=>g,metadata:()=>b,toc:()=>y});var a=t(17942),r=Object.defineProperty,i=Object.defineProperties,o=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,c=(e,n,t)=>n in e?r(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,m=(e,n)=>{for(var t in n||(n={}))s.call(n,t)&&c(e,t,n[t]);if(l)for(var t of l(n))p.call(n,t)&&c(e,t,n[t]);return e},d=(e,n)=>i(e,o(n)),u=(e,n)=>{var t={};for(var a in e)s.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&l)for(var a of l(e))n.indexOf(a)<0&&p.call(e,a)&&(t[a]=e[a]);return t};const g={},v="Advanced pipeline management",b={unversionedId:"usage/pipeline-management",id:"version-1.0/usage/pipeline-management",title:"Advanced pipeline management",description:"Using variables",source:"@site/versioned_docs/version-1.0/20-usage/90-pipeline-management.md",sourceDirName:"20-usage",slug:"/usage/pipeline-management",permalink:"/docs/usage/pipeline-management",draft:!1,editUrl:"https://github.com/woodpecker-ci/woodpecker/edit/main/docs/versioned_docs/version-1.0/20-usage/90-pipeline-management.md",tags:[],version:"1.0",sidebarPosition:90,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Status Badges",permalink:"/docs/usage/badges"},next:{title:"Setup",permalink:"/docs/administration/setup"}},f={},y=[{value:"Using variables",id:"using-variables",level:2},{value:"YAML extensions",id:"yaml-extensions",level:3},{value:"YAML extensions (alternate form)",id:"yaml-extensions-alternate-form",level:3},{value:"Persisting environment data between steps",id:"persisting-environment-data-between-steps",level:3},{value:"Declaring global variables in <code>docker-compose.yml</code>",id:"declaring-global-variables-in-docker-composeyml",level:3}],h={toc:y},O="wrapper";function k(e){var n=e,{components:t}=n,r=u(n,["components"]);return(0,a.kt)(O,d(m(m({},h),r),{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",m({},{id:"advanced-pipeline-management"}),"Advanced pipeline management"),(0,a.kt)("h2",m({},{id:"using-variables"}),"Using variables"),(0,a.kt)("p",null,'Once your pipeline starts to grow in size, it will become important to keep it DRY ("Don\'t Repeat Yourself") by using variables and environment variables. Depending on your specific need, there are a number of options.'),(0,a.kt)("h3",m({},{id:"yaml-extensions"}),"YAML extensions"),(0,a.kt)("p",null,"As described in ",(0,a.kt)("a",m({parentName:"p"},{href:"/docs/usage/advanced-yaml-syntax"}),"Advanced YAML syntax"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",m({parentName:"pre"},{className:"language-yml"}),"variables:\n  - &golang_image 'golang:1.18'\n\n steps:\n   build:\n     image: *golang_image\n     commands: build\n")),(0,a.kt)("p",null,"Note that the ",(0,a.kt)("inlineCode",{parentName:"p"},"golang_image")," alias cannot be used with string interpolation. But this is otherwise a good option for most cases."),(0,a.kt)("h3",m({},{id:"yaml-extensions-alternate-form"}),"YAML extensions (alternate form)"),(0,a.kt)("p",null,"Another approach using YAML extensions:"),(0,a.kt)("pre",null,(0,a.kt)("code",m({parentName:"pre"},{className:"language-yml"}),'variables:\n  - global_env: &global_env\n    - BASH_VERSION=1.2.3\n    - PATH_SRC=src/\n    - PATH_TEST=test/\n    - FOO=something\n\nsteps:\n  build:\n    image: bash:${BASH_VERSION}\n    directory: ${PATH_SRC}\n    commands:\n      - make ${FOO} -o ${PATH_TEST}\n    environment: *global_env\n\n  test:\n    image: bash:${BASH_VERSION}\n    commands:\n      - test ${PATH_TEST}\n    environment:\n      - <<:*global_env\n      - ADDITIONAL_LOCAL="var value"\n')),(0,a.kt)("h3",m({},{id:"persisting-environment-data-between-steps"}),"Persisting environment data between steps"),(0,a.kt)("p",null,"One can create a file containing environment variables, and then source it in each step that needs them."),(0,a.kt)("pre",null,(0,a.kt)("code",m({parentName:"pre"},{className:"language-yml"}),'steps:\n  init:\n    image: bash\n    commands:\n      echo "FOO=hello" >> envvars\n      echo "BAR=world" >> envvars\n\n  debug:\n    image: bash\n    commands:\n      - source envvars\n      - echo $FOO\n')),(0,a.kt)("h3",m({},{id:"declaring-global-variables-in-docker-composeyml"}),"Declaring global variables in ",(0,a.kt)("inlineCode",{parentName:"h3"},"docker-compose.yml")),(0,a.kt)("p",null,"As described in ",(0,a.kt)("a",m({parentName:"p"},{href:"/docs/usage/environment#global-environment-variables"}),"Global environment variables"),", one can define global variables:"),(0,a.kt)("pre",null,(0,a.kt)("code",m({parentName:"pre"},{className:"language-yml"}),"services:\n  woodpecker-server:\n    # ...\n    environment:\n      - WOODPECKER_ENVIRONMENT=first_var:value1,second_var:value2\n      # ...\n")),(0,a.kt)("p",null,"Note that this tightly couples the server and app configurations (where the app is a completely separate application). But this is a good option for truly global variables which should apply to all steps in all pipelines for all apps."))}k.isMDXComponent=!0}}]);